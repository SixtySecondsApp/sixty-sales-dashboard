import{u as S,j as e}from"./vendor-state-CpjwTZNq.js";import{r as m}from"./vendor-react-DoYyFkVR.js";import{c as k,e as U,s as u,a as t}from"./index.html-Cwo_Unfk.js";import{a2 as _,N as $,a3 as D}from"./vendor-icons-HRBKouGg.js";import{motion as y}from"./ui-animation-Dzb4KUJ1.js";import"./vendor-router-CQXjpROx.js";import"./vendor-supabase-BuXd-BBn.js";import"./vendor-utils-Cb9OXVhE.js";import"./ui-radix-core-CdvL28QE.js";import"./vendor-charts-D4YcUEy1.js";function J(){const{userData:o}=k(),{user:d,updatePassword:w}=U(),[a,l]=m.useState({firstName:"",lastName:"",email:"",currentPassword:"",newPassword:"",confirmPassword:""}),[N,p]=m.useState(!1),[n,c]=m.useState(!1),[f,x]=m.useState(!1);S(),m.useEffect(()=>{o&&l(s=>({...s,firstName:o.first_name||"",lastName:o.last_name||"",email:o.email||""}))},[o]);const j=async s=>{s.preventDefault(),c(!0),a.firstName,a.lastName,a.email;try{const{error:r}=await u.auth.updateUser({email:a.email,data:{full_name:`${a.firstName} ${a.lastName}`}});if(r)throw r;if(d?.id){const{error:i}=await u.from("profiles").update({full_name:`${a.firstName} ${a.lastName}`,username:a.email}).eq("id",d.id);if(i)throw i}t.success("Profile updated successfully")}catch(r){t.error(r.message)}finally{c(!1)}},v=async s=>{if(s.preventDefault(),c(!0),a.newPassword!==a.confirmPassword){t.error("New passwords do not match"),c(!1);return}try{const{error:r}=await w(a.newPassword);if(r)throw new Error(r.message);t.success("Password updated successfully"),p(!1),l(i=>({...i,currentPassword:"",newPassword:"",confirmPassword:""}))}catch(r){t.error(r.message)}finally{c(!1)}},P=async s=>{try{const r=s.target.files?.[0];if(!r)return;const i=r.type.toLowerCase();if(!["image/jpeg","image/png","image/gif"].includes(i)){t.error("Please upload a valid image file (JPEG, PNG, or GIF)");return}if(r.size>5*1024*1024){t.error("Image size must be less than 5MB");return}x(!0);const C=r.name.split(".").pop(),g=`${d?.id}-${Math.random()}.${C}`,{error:b}=await u.storage.from("avatars").upload(g,r);if(b)throw b;const{data:{publicUrl:E}}=u.storage.from("avatars").getPublicUrl(g);if(d?.id){const{error:h}=await u.from("profiles").update({avatar_url:E}).eq("id",d.id);if(h)throw h}t.success("Profile picture updated successfully")}catch{t.error("Upload failed"),x(!1)}};return e.jsx("div",{className:"p-4 sm:p-8 mt-12 lg:mt-0",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Profile Settings"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your account settings and preferences"})]}),e.jsx("div",{className:"bg-gray-900/50 backdrop-blur-xl rounded-xl border border-gray-800/50 overflow-hidden",children:e.jsxs("form",{onSubmit:j,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"w-24 h-24 rounded-xl overflow-hidden bg-[#37bd7e]/20 border-2 border-[#37bd7e]/30 group-hover:border-[#37bd7e]/50 transition-all duration-300",children:[o?.avatar_url?e.jsx("img",{src:o.avatar_url,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-medium text-[#37bd7e]",children:[a.firstName[0],a.lastName[0]]})}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:f?e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(_,{className:"w-6 h-6 text-white"})})]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",id:"profile-picture",onChange:P,disabled:f})]}),e.jsx("label",{htmlFor:"profile-picture",className:`text-sm text-[#37bd7e] hover:text-[#2da76c] cursor-pointer ${f?"opacity-50 cursor-not-allowed":""}`,children:f?"Uploading...":"Change Picture"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"First Name"}),e.jsx("input",{type:"text",value:a.firstName,onChange:s=>l({...a,firstName:s.target.value}),className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-xl px-4 py-2.5 text-white focus:ring-2 focus:ring-[#37bd7e] focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Last Name"}),e.jsx("input",{type:"text",value:a.lastName,onChange:s=>l({...a,lastName:s.target.value}),className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-xl px-4 py-2.5 text-white focus:ring-2 focus:ring-[#37bd7e] focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Email Address"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>l({...a,email:s.target.value}),className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-xl px-4 py-2.5 text-white focus:ring-2 focus:ring-[#37bd7e] focus:border-transparent"})]})]}),e.jsx("div",{className:"pt-6 border-t border-gray-800/50",children:e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-gray-800/50 text-white hover:bg-[#37bd7e]/20 transition-all duration-300 border border-gray-700/50 hover:border-[#37bd7e]/50",children:[e.jsx($,{className:"w-4 h-4"}),"Change Password"]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:n,className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-[#37bd7e] text-white hover:bg-[#2da76c] transition-colors",children:[e.jsx(D,{className:"w-4 h-4"}),n?"Saving...":"Save Changes"]})})]})}),N&&e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",onClick:()=>p(!1),children:e.jsxs(y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-gray-900/95 backdrop-blur-xl rounded-xl border border-gray-800/50 p-6 w-full max-w-md mx-4",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Current Password"}),e.jsx("input",{type:"password",value:a.currentPassword,onChange:s=>l({...a,currentPassword:s.target.value}),className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-xl px-4 py-2.5 text-white focus:ring-2 focus:ring-[#37bd7e] focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"New Password"}),e.jsx("input",{type:"password",value:a.newPassword,onChange:s=>l({...a,newPassword:s.target.value}),className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-xl px-4 py-2.5 text-white focus:ring-2 focus:ring-[#37bd7e] focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:a.confirmPassword,onChange:s=>l({...a,confirmPassword:s.target.value}),className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-xl px-4 py-2.5 text-white focus:ring-2 focus:ring-[#37bd7e] focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>p(!1),disabled:n,className:"px-4 py-2 rounded-xl bg-gray-800/50 text-gray-300 hover:bg-gray-800 transition-colors border border-gray-700/30",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 rounded-xl bg-[#37bd7e] text-white hover:bg-[#2da76c] transition-colors",children:n?"Updating...":"Update Password"})]})]})]})})]})})}export{J as default};
