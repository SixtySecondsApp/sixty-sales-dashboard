import{j as e}from"./vendor-state-CpjwTZNq.js";import{r as c,a as _e}from"./vendor-react-DoYyFkVR.js";import{c as he,f as ge,B as y,a as f,l as me}from"./index.html-Cwo_Unfk.js";import{C as A,a as P}from"./card-B2-KTHtJ.js";import{B as R}from"./badge-C6MYiXDB.js";import{A as ue,b as pe,a as je}from"./avatar-pcXzE_pF.js";import{I as Oe}from"./input-CeE6qNqI.js";import{S as se,a as ae,b as te,c as re,d as m}from"./select-BFsZCfaH.js";import{u as Y,a0 as Fe,c as U,S as Ae,a6 as Pe,a4 as fe,B as be,a7 as $e,k as Ee,a8 as ye,Y as ve,j as ce,a9 as $,U as I,F as Ne,T as de,M as we,P as Te,i as ze,aa as Le,ab as Me}from"./vendor-icons-HRBKouGg.js";import{AnimatePresence as le,motion as ie}from"./ui-animation-Dzb4KUJ1.js";import{Q as ne,R as oe,S as ke,T as V,U as Be}from"./vendor-utils-Cb9OXVhE.js";import{T as Ce}from"./TaskForm-Bqf2L1Og.js";import{u as Re,a as Ue,D as Ie,c as Ve,b as Ye,P as We,d as Qe,S as Ge,v as He,e as Ke,C as qe}from"./sortable.esm-Dal5CmSK.js";import{A as Je,a as Xe,b as Ze,c as es,d as ss,e as as,f as ts,g as rs}from"./alert-dialog-Z8L2pxQa.js";import"./vendor-router-CQXjpROx.js";import"./vendor-supabase-BuXd-BBn.js";import"./ui-radix-core-CdvL28QE.js";import"./vendor-charts-D4YcUEy1.js";import"./textarea-C78yVaZk.js";import"./label-B9drN7Ag.js";import"./ui-forms-D2VzSQqQ.js";import"./dialog-BBMx1wit.js";import"./popover-BxJ1Vfi_.js";import"./ui-radix-extended-CHWFg20j.js";const ls=({showCompleted:t=!1,assigneeFilter:i,compactView:p=!1,onCreateTask:n,onEditTask:x,dealId:h,companyId:j,contactId:d})=>{he();const[g,u]=c.useState(""),[o,b]=c.useState("all"),[v,E]=c.useState("all"),[C,S]=c.useState("all"),[D,W]=c.useState(!1),_=c.useMemo(()=>{const a={};return i&&(a.assigned_to=i),h&&(a.deal_id=h),j&&(a.company_id=j),d&&(a.contact_id=d),o!=="all"?o==="incomplete"?a.status=["pending","in_progress","overdue"]:a.status=[o]:t||(a.completed=!1),v!=="all"&&(a.priority=[v]),C!=="all"&&(a.task_type=[C]),g.trim()&&(a.search=g.trim()),a},[i,o,v,C,g,t,h,j,d]),{tasks:z,isLoading:M,error:B,completeTask:Q,uncompleteTask:G,deleteTask:H}=ge(_),O=async a=>{try{a.completed?(await G(a.id),f.success("Task marked as incomplete")):(await Q(a.id),f.success("Task completed!"))}catch{f.error("Failed to update task")}},K=async a=>{try{await H(a),f.success("Task deleted")}catch{f.error("Failed to delete task")}},q=a=>({call:Te,email:we,meeting:I,follow_up:de,proposal:Ne,demo:I,general:$})[a]||$,J=a=>{const s={low:"bg-blue-500/10 text-blue-400 border-blue-500/20",medium:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20",high:"bg-orange-500/10 text-orange-400 border-orange-500/20",urgent:"bg-red-500/10 text-red-400 border-red-500/20"};return s[a]||s.medium},X=a=>{const s={pending:"bg-gray-500/10 text-gray-400 border-gray-500/20",in_progress:"bg-blue-500/10 text-blue-400 border-blue-500/20",completed:"bg-green-500/10 text-green-400 border-green-500/20",cancelled:"bg-red-500/10 text-red-400 border-red-500/20",overdue:"bg-red-600/10 text-red-400 border-red-600/20"};return s[a]||s.pending},Z=a=>{const s=new Date(a),l=new Date;return ne(s)?"Today":oe(s)?"Tomorrow":ke(s)?"Yesterday":s<l?`${V(s)} ago`:V(s,{addSuffix:!0})},L=a=>!a.due_date||a.completed?!1:new Date(a.due_date)<new Date,ee=c.useMemo(()=>{const a={overdue:[],today:[],tomorrow:[],thisWeek:[],later:[],noDate:[]};return z.forEach(s=>{if(!s.due_date){a.noDate.push(s);return}const l=new Date(s.due_date),N=new Date;L(s)?a.overdue.push(s):ne(l)?a.today.push(s):oe(l)?a.tomorrow.push(s):l<=new Date(N.getTime()+7*24*60*60*1e3)?a.thisWeek.push(s):a.later.push(s)}),a},[z]);if(B)return e.jsx(A,{className:"max-w-4xl mx-auto",children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"text-center text-red-400",children:[e.jsx(Y,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:"Failed to load tasks. Please try again."})]})})});const F=h||j||d;return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[!F&&e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>W(!D),className:"border-gray-700 text-gray-300 hover:bg-gray-800",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Filters"]}),n&&e.jsxs(y,{size:"sm",className:"bg-[#37bd7e] hover:bg-[#37bd7e]/90",onClick:n,children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"New Task"]})]}),F&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-white",children:[h&&"Deal Tasks",j&&"Company Tasks",d&&"Contact Tasks"]}),e.jsx("p",{className:"text-gray-400",children:"Related tasks and follow-ups"})]}),n&&e.jsxs(y,{size:"sm",className:"bg-[#37bd7e] hover:bg-[#37bd7e]/90",onClick:n,children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Add Task"]})]}),e.jsx(le,{children:D&&!F&&e.jsx(ie.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsx(A,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(Oe,{placeholder:"Search tasks...",value:g,onChange:a=>u(a.target.value),className:"pl-9 bg-gray-800/50 border-gray-700"})]}),e.jsxs(se,{value:o,onValueChange:b,children:[e.jsx(ae,{className:"bg-gray-800/50 border-gray-700",children:e.jsx(te,{placeholder:"Status"})}),e.jsxs(re,{children:[e.jsx(m,{value:"all",children:"All Status"}),e.jsx(m,{value:"incomplete",children:"Incomplete"}),e.jsx(m,{value:"pending",children:"Pending"}),e.jsx(m,{value:"in_progress",children:"In Progress"}),e.jsx(m,{value:"completed",children:"Completed"}),e.jsx(m,{value:"overdue",children:"Overdue"})]})]}),e.jsxs(se,{value:v,onValueChange:E,children:[e.jsx(ae,{className:"bg-gray-800/50 border-gray-700",children:e.jsx(te,{placeholder:"Priority"})}),e.jsxs(re,{children:[e.jsx(m,{value:"all",children:"All Priorities"}),e.jsx(m,{value:"urgent",children:"Urgent"}),e.jsx(m,{value:"high",children:"High"}),e.jsx(m,{value:"medium",children:"Medium"}),e.jsx(m,{value:"low",children:"Low"})]})]}),e.jsxs(se,{value:C,onValueChange:S,children:[e.jsx(ae,{className:"bg-gray-800/50 border-gray-700",children:e.jsx(te,{placeholder:"Task Type"})}),e.jsxs(re,{children:[e.jsx(m,{value:"all",children:"All Types"}),e.jsx(m,{value:"call",children:"Call"}),e.jsx(m,{value:"email",children:"Email"}),e.jsx(m,{value:"meeting",children:"Meeting"}),e.jsx(m,{value:"follow_up",children:"Follow Up"}),e.jsx(m,{value:"proposal",children:"Proposal"}),e.jsx(m,{value:"demo",children:"Demo"}),e.jsx(m,{value:"general",children:"General"})]})]})]})})})})}),M?e.jsx(A,{children:e.jsx(P,{className:"p-8",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#37bd7e] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"Loading tasks..."})]})})}):e.jsxs("div",{className:"space-y-6",children:[Object.entries(ee).map(([a,s])=>{if(s.length===0)return null;const l={overdue:"Overdue",today:"Today",tomorrow:"Tomorrow",thisWeek:"This Week",later:"Later",noDate:"No Due Date"},N={overdue:"text-red-400",today:"text-orange-400",tomorrow:"text-blue-400",thisWeek:"text-gray-300",later:"text-gray-400",noDate:"text-gray-500"};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:`text-lg font-medium ${N[a]}`,children:l[a]}),e.jsx(R,{variant:"secondary",className:"bg-gray-800 text-gray-300",children:s.length})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(le,{children:s.map(r=>{const T=q(r.task_type),k=L(r);return e.jsx(ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`group ${p?"mb-1":"mb-2"}`,children:e.jsx(A,{className:`transition-all duration-200 hover:shadow-lg ${r.completed?"bg-gray-900/30 border-gray-800/30":k?"bg-red-500/5 border-red-500/20":"hover:bg-gray-800/50"}`,children:e.jsx(P,{className:p?"p-3":"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>O(r),className:`mt-1 flex-shrink-0 w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${r.completed?"bg-green-500 border-green-500":"border-gray-600 hover:border-green-500"}`,children:r.completed&&e.jsx(Pe,{className:"w-3 h-3 text-white"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(T,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("h3",{className:`font-medium ${r.completed?"line-through text-gray-500":"text-white"}`,children:r.title}),e.jsx(R,{className:`px-2 py-0.5 text-xs ${J(r.priority)}`,children:r.priority}),e.jsx(R,{className:`px-2 py-0.5 text-xs ${X(r.status)}`,children:r.status.replace("_"," ")})]}),r.description&&e.jsx("p",{className:`text-sm mb-2 ${r.completed?"text-gray-600":"text-gray-400"}`,children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 flex-wrap",children:[(r.contact_name||r.contacts?.full_name)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3"}),e.jsx("span",{children:r.contact_name||r.contacts?.full_name})]}),(r.company||r.companies?.name)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),e.jsx("span",{children:r.company||r.companies?.name})]}),r.deal?.name&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"w-3 h-3"}),e.jsx("span",{children:r.deal.name})]}),r.due_date&&e.jsxs("div",{className:`flex items-center gap-1 ${k?"text-red-400":""}`,children:[e.jsx(Ee,{className:"w-3 h-3"}),e.jsx("span",{children:Z(r.due_date)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.assignee&&e.jsxs(ue,{className:"w-6 h-6",children:[e.jsx(pe,{src:r.assignee.avatar_url}),e.jsxs(je,{className:"text-xs bg-gray-700",children:[r.assignee.first_name?.[0],r.assignee.last_name?.[0]]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[x&&e.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-gray-700",onClick:()=>x(r),children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-red-500/20 text-red-400",onClick:()=>K(r.id),children:e.jsx(ve,{className:"w-4 h-4"})})]})]})]})})]})})})},r.id)})})})]},a)}),z.length===0&&e.jsx(A,{children:e.jsx(P,{className:"p-8",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx(ce,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No tasks found"}),e.jsx("p",{children:F?"No tasks found for this context. Create a new task to get started.":"Create a new task or adjust your filters to see tasks."})]})})})]})]})},xe=[{id:"planned",name:"Planned",color:"#6B7280",icon:e.jsx($,{className:"w-4 h-4"}),description:"Tasks that are planned but not yet started"},{id:"overdue",name:"Overdue",color:"#EF4444",icon:e.jsx(Y,{className:"w-4 h-4"}),description:"Tasks that are past their due date"},{id:"started",name:"Started",color:"#3B82F6",icon:e.jsx(de,{className:"w-4 h-4"}),description:"Tasks that are currently in progress"},{id:"complete",name:"Complete",color:"#10B981",icon:e.jsx(ce,{className:"w-4 h-4"}),description:"Tasks that have been completed"}],is=({assigneeFilter:t,dealId:i,companyId:p,contactId:n,onEditTask:x})=>{he();const[h,j]=c.useState(null),[d,g]=c.useState(!1),[u,o]=c.useState(void 0),[b,v]=c.useState(null),[E,C]=c.useState(0),[S,D]=c.useState({isOpen:!1,taskId:"",taskTitle:""}),W=c.useMemo(()=>{const s={};return t&&(s.assigned_to=t),i&&(s.deal_id=i),p&&(s.company_id=p),n&&(s.contact_id=n),s},[t,i,p,n]),{tasks:_,isLoading:z,error:M,updateTask:B,deleteTask:Q,completeTask:G,uncompleteTask:H,fetchTasks:O}=ge(W);c.useEffect(()=>{E>0&&O()},[E,O]);const K=c.useMemo(()=>{const s={planned:[],overdue:[],started:[],complete:[]};return me.log("Re-grouping tasks, total count:",_.length),_.forEach(l=>{const N=new Date,r=l.due_date?new Date(l.due_date):null,T=r&&r<N;l.completed||l.status==="completed"?s.complete.push(l):l.status==="in_progress"?s.started.push(l):T&&!l.completed?s.overdue.push(l):s.planned.push(l)}),me.log("Task grouping completed:",{planned:s.planned.length,overdue:s.overdue.length,started:s.started.length,complete:s.complete.length}),s},[_,E]),q=Re(Ue(We,{activationConstraint:{distance:8}})),J=s=>{j(String(s.active.id))},X=async s=>{const{active:l,over:N}=s;if(j(null),!N||l.id===N.id)return;const r=String(l.id),T=String(N.id),k=_.find(w=>w.id===r);if(k){if(T==="overdue"&&!(k.due_date&&Be(new Date(k.due_date)))){D({isOpen:!0,taskId:k.id,taskTitle:k.title});return}try{let w={};switch(T){case"planned":w={status:"pending",completed:!1,completed_at:null};break;case"overdue":w={status:"pending",completed:!1,completed_at:null};break;case"started":w={status:"in_progress",completed:!1,completed_at:null};break;case"complete":w={status:"completed",completed:!0,completed_at:new Date().toISOString()};break}await B(r,w),T==="complete"?f.success("Task completed!"):f.success(`Task moved to ${xe.find(De=>De.id===T)?.name}`)}catch{f.error("Failed to update task")}}},Z=async()=>{if(S.taskId)try{await B(S.taskId,{due_date:new Date().toISOString(),status:"pending"}),f.success(`Task "${S.taskTitle}" marked as overdue.`),C(s=>s+1)}catch{f.error("Failed to update task.")}finally{D({isOpen:!1,taskId:"",taskTitle:""})}},L=s=>{o(void 0),v(s||"planned"),g(!0)},ee=async s=>{try{await Q(s),f.success("Task deleted")}catch{f.error("Failed to delete task")}},F=async s=>{try{s.completed?(await H(s.id),f.success("Task marked as incomplete")):(await G(s.id),f.success("Task completed!"))}catch{f.error("Failed to update task")}};if(z)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-800 rounded-lg w-48"}),e.jsx("div",{className:"h-4 bg-gray-800 rounded-lg w-80"})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-6",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"min-w-[320px] bg-gray-900/50 rounded-xl border border-gray-800/50 flex flex-col h-[600px]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-md bg-gray-800"}),e.jsx("div",{className:"h-5 bg-gray-800 rounded-lg w-20"})]}),e.jsx("div",{className:"bg-gray-800/50 rounded-full w-8 h-5"})]}),e.jsx("div",{className:"p-4 space-y-3 flex-1",children:[1,2,3].map(l=>e.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 h-32"},l))})]},s))})]});if(M)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Error loading tasks"}),e.jsx("p",{className:"text-gray-400",children:M.message})]})});const a=h?_.find(s=>s.id===h):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{onClick:()=>L(),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Add Task"]})}),e.jsxs(Ie,{sensors:q,collisionDetection:Ve,onDragStart:J,onDragEnd:X,children:[e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-6",children:xe.map(s=>e.jsx(ns,{stage:s,tasks:K[s.id]||[],onEditTask:x,onDeleteTask:ee,onCompleteTask:F,onAddTask:()=>L(s.id)},s.id))}),e.jsx(Ye,{children:a?e.jsx(Se,{task:a,isDragging:!0}):null})]}),e.jsx(Je,{open:S.isOpen,onOpenChange:s=>!s&&D({isOpen:!1,taskId:"",taskTitle:""}),children:e.jsxs(Xe,{className:"glassmorphism border-gray-700/50",children:[e.jsxs(Ze,{children:[e.jsx(es,{children:"Mark Task as Overdue?"}),e.jsxs(ss,{className:"text-gray-400",children:[`You're moving "`,S.taskTitle,'" to the Overdue column. Do you want to set its due date to now?']})]}),e.jsxs(as,{children:[e.jsx(ts,{onClick:()=>{O(),D({isOpen:!1,taskId:"",taskTitle:""})},children:"Cancel"}),e.jsx(rs,{onClick:Z,className:"bg-red-600 hover:bg-red-700",children:"Yes, Mark as Overdue"})]})]})}),e.jsx(Ce,{task:u,isOpen:d,onClose:()=>{g(!1),o(void 0),v(null),C(s=>s+1),setTimeout(()=>{O()},300)},dealId:i,companyId:p,contactId:n})]})},ns=({stage:t,tasks:i,onAddTask:p,onEditTask:n,onDeleteTask:x,onCompleteTask:h})=>{const{setNodeRef:j,isOver:d}=Qe({id:t.id}),g=c.useMemo(()=>i.map(u=>u.id),[i]);return e.jsxs("div",{className:`min-w-[320px] max-w-[320px] bg-gray-900/50 backdrop-blur-xl
        rounded-xl border border-gray-800/50 flex flex-col max-h-[calc(100vh-200px)]`,style:{transition:"border-color 150ms ease",borderColor:d?`${t.color}80`:void 0},children:[e.jsxs("div",{className:"p-4 border-b border-gray-800/50 flex items-center justify-between sticky top-0 z-10 bg-gray-900/80 backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-md flex items-center justify-center",style:{backgroundColor:t.color},children:_e.cloneElement(t.icon,{className:"w-3 h-3 text-white"})}),e.jsx("h3",{className:"font-semibold text-white",children:t.name})]}),e.jsx("div",{className:"bg-gray-800/50 px-2.5 py-0.5 rounded-full text-xs text-gray-400",children:i.length})]}),e.jsxs("div",{ref:j,className:`
          flex-1 overflow-y-auto p-4 space-y-3
          ${d?"bg-gray-800/30 ring-1 ring-inset":""}
          scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent
          transition-all duration-150
        `,style:d?{"--ring-color":`${t.color}40`}:{},children:[e.jsxs(Ge,{items:g,strategy:He,children:[i.length===0&&!d&&e.jsx("div",{className:"text-gray-500 text-center text-sm h-20 flex items-center justify-center border border-dashed border-gray-800/50 rounded-lg",children:"Drop tasks here"}),e.jsx(le,{children:i.map(u=>e.jsx(ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:e.jsx(Se,{task:u,onEdit:n?()=>n(u):void 0,onDelete:()=>x(u.id),onComplete:()=>h(u)})},u.id))})]}),e.jsxs("button",{onClick:p,className:`w-full h-12 flex items-center justify-center gap-2
            bg-transparent border border-dashed border-gray-700 rounded-lg
            text-gray-400 hover:text-gray-300 hover:bg-gray-800/30
            transition-colors mt-2`,children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Add task"})]})]})]})},Se=({task:t,isDragging:i=!1,onEdit:p,onDelete:n,onComplete:x})=>{const h=o=>({call:Te,email:we,meeting:I,follow_up:de,proposal:Ne,demo:I,general:$})[o]||$,j=o=>{const b={low:"bg-blue-500/10 text-blue-400 border-blue-500/20",medium:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20",high:"bg-orange-500/10 text-orange-400 border-orange-500/20",urgent:"bg-red-500/10 text-red-400 border-red-500/20"};return b[o]||b.medium},d=o=>{const b=new Date(o),v=new Date;return ne(b)?"Today":oe(b)?"Tomorrow":ke(b)?"Yesterday":b<v?`${V(b)} ago`:V(b,{addSuffix:!0})},g=()=>!t.due_date||t.completed?!1:new Date(t.due_date)<new Date,u=h(t.task_type);return e.jsx(os,{taskId:t.id,isDragging:i,children:e.jsx(A,{className:`
        bg-gray-800/50 border-gray-700/50 hover:bg-gray-800/70 
        transition-all duration-200 cursor-grab active:cursor-grabbing
        ${i?"opacity-50 rotate-3 scale-105":""}
        ${g()?"ring-1 ring-red-500/30":""}
      `,children:e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(u,{className:"w-4 h-4 text-gray-400"}),e.jsx("h4",{className:"font-medium text-white text-sm leading-tight line-clamp-2",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[p&&e.jsx(y,{size:"sm",variant:"ghost",onClick:o=>{o.stopPropagation(),p()},className:"h-6 w-6 p-0 hover:bg-gray-700/50",children:e.jsx(ye,{className:"w-3 h-3"})}),n&&e.jsx(y,{size:"sm",variant:"ghost",onClick:o=>{o.stopPropagation(),n()},className:"h-6 w-6 p-0 hover:bg-red-500/20 hover:text-red-400",children:e.jsx(ve,{className:"w-3 h-3"})})]})]}),t.description&&e.jsx("p",{className:"text-xs text-gray-400 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(R,{className:`text-xs border ${j(t.priority)}`,children:t.priority}),x&&e.jsx(y,{size:"sm",variant:"ghost",onClick:o=>{o.stopPropagation(),x()},className:`h-6 w-6 p-0 ${t.completed?"text-green-400 hover:bg-green-500/20":"text-gray-400 hover:bg-gray-700/50"}`,children:t.completed?e.jsx(ce,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"})})]}),t.due_date&&e.jsxs("div",{className:`flex items-center gap-1 text-xs ${g()?"text-red-400":"text-gray-400"}`,children:[e.jsx(ze,{className:"w-3 h-3"}),e.jsx("span",{children:d(t.due_date)}),g()&&e.jsx(Y,{className:"w-3 h-3 text-red-400"})]}),(t.contact_name||t.company)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-700/50",children:[t.contact_name&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mb-1",children:[e.jsx(fe,{className:"w-3 h-3"}),e.jsx("span",{children:t.contact_name})]}),t.company&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[e.jsx(be,{className:"w-3 h-3"}),e.jsx("span",{children:t.company})]})]}),t.assignee&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-gray-700/50",children:[e.jsxs(ue,{className:"h-5 w-5",children:[e.jsx(pe,{src:t.assignee.avatar_url}),e.jsx(je,{className:"text-xs bg-gray-700",children:(t.assignee.first_name?.[0]||"")+(t.assignee.last_name?.[0]||"")})]}),e.jsxs("span",{className:"text-xs text-gray-400",children:[t.assignee.first_name," ",t.assignee.last_name]})]})]})})})},os=({taskId:t,children:i,isDragging:p=!1})=>{const{attributes:n,listeners:x,setNodeRef:h,transform:j,transition:d,isDragging:g}=Ke({id:t}),u={transform:qe.Transform.toString(j),transition:d};return e.jsx("div",{ref:h,style:u,...n,...x,className:p||g?"z-50":"",children:i})},Ps=()=>{const[t,i]=c.useState(!1),[p,n]=c.useState(void 0),[x,h]=c.useState("kanban"),j=()=>{n(void 0),i(!0)},d=u=>{n(u),i(!0)},g=()=>{i(!1),n(void 0)};return e.jsxs("div",{className:"min-h-screen bg-gray-950 p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Tasks"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your tasks and stay organized"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-800/50 rounded-lg p-1",children:[e.jsxs(y,{variant:x==="list"?"default":"ghost",size:"sm",onClick:()=>h("list"),className:`
              ${x==="list"?"bg-blue-600 hover:bg-blue-700 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}
              transition-all duration-200
            `,children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"List View"]}),e.jsxs(y,{variant:x==="kanban"?"default":"ghost",size:"sm",onClick:()=>h("kanban"),className:`
              ${x==="kanban"?"bg-blue-600 hover:bg-blue-700 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}
              transition-all duration-200
            `,children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Kanban View"]})]})]}),x==="list"?e.jsx(ls,{showCompleted:!1,onCreateTask:j,onEditTask:d}):e.jsx(is,{onEditTask:d}),e.jsx(Ce,{task:p,isOpen:t,onClose:g})]})};export{Ps as default};
