# Prometheus Configuration for Sixty Sales Dashboard\n# Optimized for production monitoring with comprehensive metrics collection\n\nglobal:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n  external_labels:\n    cluster: 'production'\n    service: 'sixty-sales-dashboard'\n\n# Alertmanager configuration\nalerting:\n  alertmanagers:\n    - static_configs:\n        - targets:\n          - alertmanager:9093\n\n# Load rules once and periodically evaluate them\nrule_files:\n  - \"alert_rules.yml\"\n  - \"recording_rules.yml\"\n\n# Scrape configurations\nscrape_configs:\n  # Prometheus self-monitoring\n  - job_name: 'prometheus'\n    static_configs:\n      - targets: ['localhost:9090']\n    scrape_interval: 30s\n    metrics_path: /metrics\n\n  # Node Exporter (System metrics)\n  - job_name: 'node-exporter'\n    static_configs:\n      - targets: ['node-exporter:9100']\n    scrape_interval: 30s\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: instance\n        regex: '(.*)'\n        replacement: '${1}'\n\n  # Application Frontend (Nginx)\n  - job_name: 'nginx'\n    static_configs:\n      - targets: ['nginx-exporter:9113']\n    scrape_interval: 30s\n    metrics_path: /metrics\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: component\n        replacement: 'frontend'\n\n  # Application Backend API\n  - job_name: 'api-backend'\n    static_configs:\n      - targets: ['api:8000']\n    metrics_path: '/api/metrics'\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: component\n        replacement: 'backend'\n\n  # Redis metrics\n  - job_name: 'redis'\n    static_configs:\n      - targets: ['redis-exporter:9121']\n    scrape_interval: 30s\n    metrics_path: /metrics\n\n  # PostgreSQL metrics  \n  - job_name: 'postgres'\n    static_configs:\n      - targets: ['postgres-exporter:9187']\n    scrape_interval: 30s\n    metrics_path: /metrics\n\n  # Cadvisor (Container metrics)\n  - job_name: 'cadvisor'\n    static_configs:\n      - targets: ['cadvisor:8080']\n    scrape_interval: 30s\n    metrics_path: /metrics\n    relabel_configs:\n      - source_labels: [__name__]\n        regex: 'container_.*'\n        target_label: __name__\n        replacement: '${1}'\n\n  # Blackbox Exporter (Uptime monitoring)\n  - job_name: 'blackbox-http'\n    metrics_path: /probe\n    params:\n      module: [http_2xx]\n    static_configs:\n      - targets:\n        - https://yourdomain.com\n        - https://yourdomain.com/health\n        - https://yourdomain.com/dashboard\n        - https://yourdomain.com/api/health\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: blackbox-exporter:9115\n\n  # SSL Certificate monitoring\n  - job_name: 'blackbox-ssl'\n    metrics_path: /probe\n    params:\n      module: [ssl_expire]\n    static_configs:\n      - targets:\n        - yourdomain.com:443\n        - api.yourdomain.com:443\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: blackbox-exporter:9115\n\n  # Custom application metrics\n  - job_name: 'app-custom-metrics'\n    static_configs:\n      - targets: ['api:8000']\n    metrics_path: '/api/metrics/custom'\n    scrape_interval: 60s\n    honor_labels: true\n\n  # Performance monitoring (if using dedicated service)\n  - job_name: 'performance-monitor'\n    static_configs:\n      - targets: ['performance-monitor:3001']\n    metrics_path: /metrics\n    scrape_interval: 60s\n\n# Remote write configuration (for long-term storage)\n# Uncomment if using external time series database\n# remote_write:\n#   - url: 'https://your-remote-storage.com/api/v1/write'\n#     basic_auth:\n#       username: 'your_username'\n#       password: 'your_password'\n#     write_relabel_configs:\n#       - source_labels: [__name__]\n#         regex: 'high_cardinality_metric.*'\n#         action: drop\n\n# Storage configuration\nstorage:\n  tsdb:\n    path: /prometheus\n    retention.time: 30d\n    retention.size: 10GB\n    # Optimize for SSD storage\n    wal-compression: true\n    # Reduce memory usage\n    min-block-duration: 2h\n    max-block-duration: 25h\n\n# Query configuration\nquery:\n  timeout: 2m\n  max_concurrency: 20\n  max_samples: 50000000\n\n# Web configuration\nweb:\n  console.templates: /etc/prometheus/consoles\n  console.libraries: /etc/prometheus/console_libraries\n  enable-lifecycle: true\n  enable-admin-api: false"