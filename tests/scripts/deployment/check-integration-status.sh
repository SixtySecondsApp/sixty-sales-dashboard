#!/bin/bash

echo "üîç Checking Fathom Integration Status..."
echo ""
echo "üìß User Email: andrew@sixty.xyz"
echo ""
echo "Please run this SQL query in Supabase SQL Editor:"
echo "https://supabase.com/dashboard/project/ewtuefzeogytgmsnkpmb/editor"
echo ""
echo "==========================================="
echo "SELECT"
echo "    user_id,"
echo "    fathom_user_email,"
echo "    is_active,"
echo "    created_at,"
echo "    token_expires_at,"
echo "    CASE"
echo "        WHEN token_expires_at < NOW() THEN '‚ùå EXPIRED'"
echo "        WHEN token_expires_at < NOW() + INTERVAL '1 day' THEN '‚ö†Ô∏è  EXPIRES SOON'"
echo "        ELSE '‚úÖ VALID'"
echo "    END as token_status"
echo "FROM fathom_integrations"
echo "WHERE fathom_user_email = 'andrew@sixty.xyz';"
echo "==========================================="
echo ""
echo "Expected Result:"
echo "- 1 row returned"
echo "- is_active = true"
echo "- token_status = '‚úÖ VALID'"
echo ""
echo "If NO rows returned:"
echo "  ‚Üí Go to Settings ‚Üí Integrations in your CRM"
echo "  ‚Üí Click 'Connect' or 'Reconnect' Fathom"
echo "  ‚Üí Follow OAuth flow"
echo ""
echo "If token EXPIRED:"
echo "  ‚Üí Same as above - reconnect Fathom"
echo ""
